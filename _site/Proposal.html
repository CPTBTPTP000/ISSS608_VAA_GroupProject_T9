<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="FAN JING, LAI MEIHAO, LIN XINYUE">
<meta name="dcterms.date" content="2025-03-11">

<title>Project Proposal â€“ Blue PulseðŸ’§</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Blue PulseðŸ’§</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Proposal.html" aria-current="page"> 
<span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-team" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Team</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-team">    
        <li>
    <a class="dropdown-item" href="./about.html">
 <span class="dropdown-text">About this project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./MeetingMinutes.html">
 <span class="dropdown-text">Meeting Minutes</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#problem-statement" id="toc-problem-statement" class="nav-link" data-scroll-target="#problem-statement">Problem Statement</a></li>
  <li><a href="#data-source-scope" id="toc-data-source-scope" class="nav-link" data-scroll-target="#data-source-scope">Data Source &amp; Scope</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning: &nbsp;</a></li>
  <li><a href="#filtering-and-transformation" id="toc-filtering-and-transformation" class="nav-link" data-scroll-target="#filtering-and-transformation">Filtering and Transformation &nbsp;</a></li>
  <li><a href="#data-integration" id="toc-data-integration" class="nav-link" data-scroll-target="#data-integration">Data Integration</a></li>
  </ul></li>
  <li><a href="#geospatial-data-analysis" id="toc-geospatial-data-analysis" class="nav-link" data-scroll-target="#geospatial-data-analysis">Geospatial Data Analysis &nbsp;</a></li>
  <li><a href="#time-series-analysis" id="toc-time-series-analysis" class="nav-link" data-scroll-target="#time-series-analysis">Time series Analysis &nbsp;</a></li>
  <li><a href="#confirmatory-data-analysis-cda" id="toc-confirmatory-data-analysis-cda" class="nav-link" data-scroll-target="#confirmatory-data-analysis-cda">Confirmatory Data Analysis (CDA)&nbsp;</a></li>
  </ul></li>
  <li><a href="#prototype" id="toc-prototype" class="nav-link" data-scroll-target="#prototype">Prototype</a>
  <ul class="collapse">
  <li><a href="#geospatial-data-analysis-1" id="toc-geospatial-data-analysis-1" class="nav-link" data-scroll-target="#geospatial-data-analysis-1">Geospatial Data Analysis</a></li>
  <li><a href="#time-series-analysis-1" id="toc-time-series-analysis-1" class="nav-link" data-scroll-target="#time-series-analysis-1">Time series Analysis</a></li>
  <li><a href="#confirmatory-data-analysis-cda-1" id="toc-confirmatory-data-analysis-cda-1" class="nav-link" data-scroll-target="#confirmatory-data-analysis-cda-1">Confirmatory Data Analysis (CDA)&nbsp;</a></li>
  </ul></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R packages</a></li>
  <li><a href="#project-schedule" id="toc-project-schedule" class="nav-link" data-scroll-target="#project-schedule">Project Schedule</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Proposal</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>FAN JING, LAI MEIHAO, LIN XINYUE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 11, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 12, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<p><img src="images/clipboard-2701253536.png" class="img-fluid"></p>
<p>Image source: The guardian</p>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>Water is essential for life, yet millions around the world still lack access to clean water and sanitation. As of 2022, <strong>2.2 billion</strong> <strong>people</strong> lacked safely managed drinking water and basic hand-washing facilities, <strong>3.5 billion</strong> lacked safely managed sanitation and <strong>2.4 billion</strong> lived in water-stressed countries.</p>
<p><a href="https://sdgs.un.org/goals/goal6">Sustainable Development Goal 6 (SDG 6)</a>aims to ensure universal access to water and sanitation. However, at the current pace, billions will continue to face these challenges by 2030.</p>
<p><img src="images/clipboard-3249475822-01.png" class="img-fluid" width="290"></p>
</section>
<section id="problem-statement" class="level1">
<h1>Problem Statement</h1>
<p>To meet <a href="https://sdgs.un.org/goals/goal6">Sustainable Development Goal 6 (SDG 6)</a> targets, the global rate of progress must accelerate significantly â€” 6x for drinking water, 5x for sanitation, and 3x for hygiene. Achieving these targets would save <strong>829,000 lives</strong> annually, the number of people who currently die each year from disease directly linked to unsafe water, inadequate sanitation and poor hygiene.</p>
<p>This project aims to analyze and visualize global water accessibility, sanitation trends and their impact on public health. Using data from the World Bank and health related dataset, we will:</p>
<ul>
<li><p>Identify spatial disparities in clean water access and unsafe water-related deaths.</p></li>
<li><p>Analyze time-series trends to assess progress in water safety and sanitation overtime.</p></li>
<li><p>Examine statistical relationship between water access and disease prevalence (Cholera, Typhoid)</p></li>
<li><p>Assess investment gaps by analyzing government and international funding in water infrastructure and sanitation programs</p></li>
<li><p>Evaluate trans boundary water cooperation, identifying region where shared water resources requires coordinated management to improve accessibility and sustainability.</p></li>
</ul>
<p>This project aims to support efforts in ensuring universal access to clean water and improving global health outcome through data driven approach</p>
</section>
<section id="data-source-scope" class="level1">
<h1>Data Source &amp; Scope</h1>
<p>This project will explore global trend in water accessibility sanitation and related health impacts using multiple datasets. The primary source is the<a href="https://databank.worldbank.org/reports.aspx?source=2&amp;series=SP.POP.TOTL&amp;country=">World Development Indicators (WDI)</a> from the World Bank, which compiles extensive development data across 266 countries from 1960 to 2023. Given the large dataset, only relevant indicators will be selected to align with the projectâ€™s objectives.</p>
<p>Potential variables from WDI may include indicators related to drinking water access, sanitation services, hygiene practices, water stress and water productivity. These factors will help assess disparities in water availability and quality across different regions.</p>
<p>Additionally, the project will incorporate health related datasets to examine the link between water conditions and waterborne disease prevalence:</p>
<ul>
<li><p><a href="https://osf.io/kew4d/">Typhoid Fever Incidence (2000 -2022)</a> from the Center for Open Science (OSF)</p></li>
<li><p><a href="https://www.kaggle.com/datasets/imdevskp/cholera-dataset">Cholera Case Data (from 1949 onward)</a>, extracted from the <a href="https://apps.who.int/gho/data/node.main.174?lang=en">WHO</a>on Kaggle</p></li>
</ul>
<p>By integrating these data sources, the project aims to provide data-driven insight into the impact of water accessibility and sanitation on public health. This findings can help policy makers, organizations and government target resource more effectively to ensure equitable access to safe water and sanitation worldwide.</p>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  subgraph "Water Accessibility and Safety Analysis"
    A(OSF Typhoid outbreak &amp; World Bank World WDI &amp; Cholera Outbreak from Kaggle) --&gt; B(Read Input)

    subgraph "Data Preparation"
      B --&gt; C(Data Cleaning)
      C --&gt; C1(Handle Missing Values)
      C1 --&gt; C2(Remove Duplicates)
      C2 --&gt; C3(Standardize Formats)
      C3 --&gt; D(Filtering &amp; Transformation)
      D --&gt; D1(Select Key Variables)

      D1 --&gt; E(Data Integration)
      E --&gt; E1(Merge WHO &amp; WB Data)
      E1 --&gt; E2(Geocode for Mapping)
      E2 --&gt; E3(Final Data Processing)
      E3 --&gt; F(Prepare Data for Analysis)
    end

    F --&gt; G
    F --&gt; H
    F --&gt; I
    F --&gt; J

    subgraph "Geospatial Data Analysis"
      G(Create Heat Maps)
      H(Create Choropleth Maps)
      I(Identify Spatial Disparities)
      G --&gt; L(Geospatial Insights)
      H --&gt; L
      I --&gt; L
    end

    subgraph "Time Series Analysis"
      J(Trend &amp; Forecasting) --&gt; L1(ARIMA, STL, SARIMA)
      L1 --&gt; M(Project Future Trends)
      M --&gt; N(Interactive Time Sliders)
      M --&gt; O(Evaluate Forecasting Models)
    end

    L --&gt; P
    N --&gt; P
    O --&gt; P

    subgraph "Confirmatory Data Analysis"
      P(Correlation Analysis)
      P --&gt; Q(Hypothesis Testing: t-test, ANOVA)
      P --&gt; R(Regression Models)
    end

    Q --&gt; S
    R --&gt; S

    subgraph "Data Exploration &amp; Visualization"
      S(Interactive Dashboard - Shiny App)
    end
  end

</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<p>Before conducting any analysis, we will ensure that the dataset is clean, structured for analysis, and suitable for visualization. The following steps will be taken:&nbsp;</p>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning: &nbsp;</h3>
<ul>
<li>Handling Missing value (removal of incomplete records)&nbsp;</li>
<li>Identify and remove duplicate records&nbsp;</li>
<li>Standardize data formats (date formats, numerical conversions)&nbsp;</li>
</ul>
</section>
<section id="filtering-and-transformation" class="level3">
<h3 class="anchored" data-anchor-id="filtering-and-transformation">Filtering and Transformation &nbsp;</h3>
<ul>
<li>Select key variables relevant to the study, such as clean water access,</li>
</ul>
</section>
<section id="data-integration" class="level3">
<h3 class="anchored" data-anchor-id="data-integration">Data Integration</h3>
<ul>
<li>Merge data on typhoid outbreaks (2000â€“2022) from the Center for Open Science (OSF), cholera cases from the WHO (2000â€“2023) via Kaggle (extra from WHO), and World Development Indicators (WDI) from the World Bank (2000â€“2023) to analyze the relationship between waterborne diseases and access to unsafe water sources. This integration will help assess how trends in cholera and typhoid correlate with water quality and accessibility over time.</li>
<li>Geocode data for geospatial visualization &nbsp;</li>
</ul>
</section>
</section>
<section id="geospatial-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-analysis">Geospatial Data Analysis &nbsp;</h2>
<p>The objective of the geospatial Data Analysis is to understand and identify spatial disparities in water accessibility and unsafe water-related deaths while assessing investment gaps and policy effectiveness.&nbsp;</p>
<p>Visualization Approach:</p>
<ul>
<li>Interactive heat map will be developed that represents:&nbsp;
<ul>
<li>Areas with low access to clean water &nbsp;</li>
<li>High Concentration of unsafe water usage &nbsp;</li>
<li>Outbreak cases of Cholera and Typhoid</li>
</ul></li>
<li>Choropleth Maps will be used to illustrate severity levels with different color intensities represents:
<ul>
<li><p>Water stress levels and sanitation access disparities</p></li>
<li><p>Disease incidence across different region</p></li>
<li><p>Transboundary water cooperation gaps in shared water resources.</p></li>
<li><p>Policy effectiveness, comparing investment levels vs actual progress in improving water access and sanitation</p></li>
<li><p>Investment disparities in water and sanitation infrastructure showing region with high vs.low funding levels.</p></li>
</ul></li>
</ul>
</section>
<section id="time-series-analysis" class="level2">
<h2 class="anchored" data-anchor-id="time-series-analysis">Time series Analysis &nbsp;</h2>
<p>The object of this analysis is to identify the trend and predict future patterns in water safety and sanitation overtime and related health risks over time.</p>
<p>Incorporate forecasting models using Autoregressive Integrated Moving Average (ARIMA) for overall trend forecasting, Seasonal Decomposition of Time Series (STL) to analyse the seasonal variation and long term patterns and Seasonal Autoregressive Integrated Moving Average (SARIMA) to incorporate both trend and seasonality to project future trends in: &nbsp;</p>
<ul>
<li><p>Water accessibility improvements over the years</p></li>
<li><p>Death rates linked to unsafe water (waterborne disease incidence trends).</p></li>
<li><p>Changes in sanitation coverage</p></li>
</ul>
</section>
<section id="confirmatory-data-analysis-cda" class="level2">
<h2 class="anchored" data-anchor-id="confirmatory-data-analysis-cda">Confirmatory Data Analysis (CDA)&nbsp;</h2>
<p>The objective of confirmatory data analysis is to validate the statistical relationship between water accessibility sanitation and health outcomes using correlation, hypothesis testing and regression models.</p>
<ul>
<li><p>Correlation Analysis</p>
<ul>
<li><p>Assess the relationship between clean water access and the incidence of waterborne disease (Cholera &amp; Typhoid)</p></li>
<li><p>Examine how unsafe water exposure correlates with mortality rates due to waterborne dieases.</p></li>
</ul></li>
<li><p>Hypothesis Testing:</p>
<ul>
<li>Conduct t-tests and ANOVA to determine if significant different exist in water access levels across different regions.</li>
</ul></li>
<li><p>Regression Modelling:</p>
<ul>
<li><p>Evaluate the impact of sanitation access and clean water availability on the incidence of waterborne diseases</p></li>
<li><p>Quantify the extent to which improvements in water infrastructure reduce health risks.</p></li>
<li><p>Assess the effect of investment in water and sanitation on overall health outcomes.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="prototype" class="level1">
<h1>Prototype</h1>
<section id="geospatial-data-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-analysis-1">Geospatial Data Analysis</h2>
<p>With this tab, users can freely select the variables they want to explore from 2012-2022. Additionally, by selecting different regions, they can gain deeper insights into specific areas. The data table below allows users to conveniently view detailed information.</p>
<p><img src="images/1871269457c1f72b36efd4e29951bbc.jpg" class="img-fluid" width="420"></p>
</section>
<section id="time-series-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="time-series-analysis-1">Time series Analysis</h2>
<p>This tab will display time series forecasting. Users can explore the basic information of the data and use different models for forecasting.</p>
<p><img src="images/10eb0b424332b246c9e6d517157e520.jpg" class="img-fluid" width="420"></p>
</section>
<section id="confirmatory-data-analysis-cda-1" class="level2">
<h2 class="anchored" data-anchor-id="confirmatory-data-analysis-cda-1">Confirmatory Data Analysis (CDA)&nbsp;</h2>
<p>This tab will use statistical methods to analyze and validate the relationships between data based on user selections, providing a clearer understanding of the impact of water stress, sanitation, and hygiene.</p>
<p><img src="images/3a15416b3910b816c7c2937bf9f063b.jpg" class="img-fluid" width="420"></p>
</section>
</section>
<section id="r-packages" class="level1">
<h1>R packages</h1>
<p>The team intends to use the following R packages to develop and deploy the interactive visual analytics application</p>
<ul>
<li><p><strong>tidyverse</strong>: A family of modern R packages specially designed to support data science, analysis, and communication tasks, including creating static statistical graphs.</p></li>
<li><p><strong>knitr</strong>: A report generation tool that facilitates dynamic document creation in R.</p></li>
<li><p><strong>dplyr</strong>: An R package for data manipulation and working with data frames efficiently.</p></li>
<li><p><strong>plotly</strong>: An R library for plotting interactive statistical graphs and visualizing data dynamically.</p></li>
<li><p><strong>DT</strong>: An R interface to the JavaScript library <strong>DataTables</strong>, which creates interactive tables for HTML pages.</p></li>
<li><p><strong>lubridate</strong>: An R package that simplifies working with <strong>dates and time elements</strong>.</p></li>
<li><p><strong>ggforce</strong>: An extension of <strong>ggplot2</strong> that provides additional geoms and stats for advanced visual data analysis.</p></li>
<li><p><strong>highcharter</strong>: A wrapper around the â€˜Highchartsâ€™ JavaScript library, allowing for highly interactive and customizable plotting of R objects.</p></li>
<li><p><strong>sf</strong>: An R package that supports the <strong>importing, managing, and processing of geospatial data</strong>, essential for mapping analysis.</p></li>
<li><p><strong>spdep</strong>: An R package that facilitates spatial analysis by handling geospatial data dependencies and relationships.</p></li>
</ul>
</section>
<section id="project-schedule" class="level1">
<h1>Project Schedule</h1>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Proposal_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>